<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sankalp Shiksha - Premium AI Quiz Generator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', 'Segoe UI', sans-serif;
            transition: background-color 0.3s, color 0.3s, transform 0.3s, box-shadow 0.3s;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #f0f0f0;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100" opacity="0.05"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="white"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            z-index: -1;
        }
        
        .gold-accent {
            color: #d4af37;
        }
        
        .premium-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: linear-gradient(45deg, #d4af37, #f7ef8a);
            color: #1a1a2e;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 3px 10px;
            border-radius: 20px;
            transform: rotate(15deg);
            box-shadow: 0 3px 10px rgba(212, 175, 55, 0.4);
            z-index: 10;
        }
        
        .container {
            width: 95%;
            max-width: 1200px;
            background: rgba(26, 26, 46, 0.85);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            padding: 40px;
            margin: 20px 0;
            position: relative;
            border: 1px solid rgba(212, 175, 55, 0.2);
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d4af37, #f7ef8a, #d4af37);
            border-radius: 20px 20px 0 0;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            padding: 10px 0;
        }
        
        h1 {
            color: #f0f0f0;
            margin-bottom: 10px;
            font-size: 2.8rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .description {
            color: #bdc3c7;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .logo {
            font-size: 3.5rem;
            margin-bottom: 15px;
            color: #d4af37;
            text-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }
        
        .form-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #f0f0f0;
            font-size: 1rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 10px;
            font-size: 1rem;
            background: rgba(15, 52, 96, 0.5);
            color: #f0f0f0;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #d4af37;
            outline: none;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }
        
        button {
            background: linear-gradient(135deg, #d4af37 0%, #f7ef8a 100%);
            color: #1a1a2e;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.4);
        }
        
        button.secondary {
            background: rgba(15, 52, 96, 0.7);
            color: #f0f0f0;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }
        
        button.secondary:hover {
            background: rgba(15, 52, 96, 0.9);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .quiz-container, .results-container {
            display: none;
        }
        
        .question {
            background: rgba(15, 52, 96, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .option {
            padding: 15px;
            background: rgba(26, 26, 46, 0.7);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: 500;
            font-size: 1rem;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .option:hover {
            background: rgba(26, 26, 46, 0.9);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .selected {
            background: linear-gradient(135deg, #d4af37 0%, #f7ef8a 100%);
            color: #1a1a2e;
            border-color: #d4af37;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .nav-btn {
            width: 48%;
        }
        
        .results-container {
            text-align: center;
        }
        
        .score {
            font-size: 2.5rem;
            font-weight: bold;
            color: #f0f0f0;
            margin: 25px 0;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .analysis {
            text-align: left;
            background: rgba(15, 52, 96, 0.5);
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            font-size: 1rem;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .correct {
            color: #2ecc71;
            font-weight: bold;
        }
        
        .incorrect {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .progress {
            height: 10px;
            background: rgba(15, 52, 96, 0.5);
            border-radius: 5px;
            margin-bottom: 25px;
            overflow: hidden;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #d4af37, #f7ef8a);
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        
        .spinner {
            border: 4px solid rgba(15, 52, 96, 0.5);
            border-top: 4px solid #d4af37;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }
        
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #d4af37 0%, #f7ef8a 100%);
            color: #1a1a2e;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-right: 10px;
            font-weight: 600;
        }
        
        .header-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .control-btn {
            width: auto;
            padding: 12px 20px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .quiz-header-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .timer-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px 20px;
            background: rgba(15, 52, 96, 0.5);
            border-radius: 15px;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .timer {
            font-size: 1.4rem;
            font-weight: bold;
            color: #f0f0f0;
        }
        
        .timer.warning {
            color: #e74c3c;
            animation: pulse 1s infinite;
        }
        
        .footer {
            margin-top: 40px;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.95rem;
        }
        
        .footer a {
            color: #d4af37;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .footer a:hover {
            text-decoration: underline;
            color: #f7ef8a;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: rgba(26, 26, 46, 0.95);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }
        
        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d4af37, #f7ef8a, #d4af37);
            border-radius: 15px 15px 0 0;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            color: #d4af37;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            color: #f7ef8a;
            transform: scale(1.2);
        }
        
        .question-analysis {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .question-analysis:last-child {
            border-bottom: none;
        }
        
        .correct-answer {
            background: rgba(46, 204, 113, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 0.95rem;
            border-left: 4px solid #2ecc71;
        }
        
        .explanation {
            background: rgba(52, 152, 219, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 0.95rem;
            border-left: 4px solid #3498db;
        }
        
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .quiz-title {
            font-size: 1.8rem;
            color: #f0f0f0;
            font-family: 'Playfair Display', serif;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
        }
        
        .action-btn {
            padding: 10px 18px;
            width: auto;
        }
        
        .share-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .share-btn {
            width: auto;
            padding: 12px 20px;
        }
        
        .share-btn.facebook {
            background: #3b5998;
        }
        
        .share-btn.twitter {
            background: #1da1f2;
        }
        
        .share-btn.whatsapp {
            background: #25d366;
        }
        
        .centered-button-container {
            display: flex;
            justify-content: center;
            margin: 25px 0;
        }
        
        .centered-button {
            width: 100%;
            max-width: 350px;
        }
        
        .mode-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(26, 26, 46, 0.9);
            color: #d4af37;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 50%;
            width: 55px;
            height: 55px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 100;
            transition: all 0.3s;
        }
        
        .mode-toggle:hover {
            background: rgba(212, 175, 55, 0.2);
            transform: scale(1.1);
        }
        
        .instructions-toggle {
            position: absolute;
            top: 20px;
            right: 90px;
            background: rgba(26, 26, 46, 0.9);
            color: #d4af37;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 50%;
            width: 55px;
            height: 55px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 100;
            transition: all 0.3s;
        }
        
        .instructions-toggle:hover {
            background: rgba(212, 175, 55, 0.2);
            transform: scale(1.1);
        }
        
        .review-panel {
            background: rgba(15, 52, 96, 0.5);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .review-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
        }
        
        .review-status {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-color {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .status-answered {
            background-color: #2ecc71;
        }
        
        .status-skipped {
            background-color: #f39c12;
        }
        
        .status-unanswered {
            background-color: #e74c3c;
        }
        
        .status-current {
            background-color: #3498db;
        }
        
        .review-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        
        .review-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            border: 2px solid rgba(212, 175, 55, 0.3);
            background: rgba(26, 26, 46, 0.7);
            color: #f0f0f0;
            transition: all 0.2s;
        }
        
        .review-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .review-btn.answered {
            background: #2ecc71;
            color: white;
            border-color: #2ecc71;
        }
        
        .review-btn.skipped {
            background: #f39c12;
            color: white;
            border-color: #f39c12;
        }
        
        .review-btn.unanswered {
            background: #e74c3c;
            color: white;
            border-color: #e74c3c;
        }
        
        .review-btn.current {
            border: 2px solid #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.8);
        }
        
        .user-details-form {
            margin-top: 20px;
        }
        
        .user-details-form .form-group {
            margin-bottom: 20px;
        }
        
        .user-details-form label {
            margin-bottom: 8px;
        }
        
        .user-details-form input {
            padding: 12px;
        }
        
        .form-required {
            color: #e74c3c;
        }
        
        .user-details-submit {
            margin-top: 15px;
            width: 100%;
        }
        
        .feedback-form .form-group {
            margin-bottom: 20px;
        }
        
        .feedback-form label {
            margin-bottom: 8px;
        }
        
        .feedback-form textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .feedback-submit {
            margin-top: 15px;
            width: 100%;
        }
        
        .feedback-success {
            display: none;
            text-align: center;
            padding: 30px;
            color: #2ecc71;
        }
        
        .feedback-success i {
            font-size: 3.5rem;
            margin-bottom: 20px;
        }
        
        .premium-feature {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 10px;
            border-left: 4px solid #d4af37;
        }
        
        .premium-feature i {
            color: #d4af37;
            font-size: 1.5rem;
        }
        
        .email-notice {
            background: rgba(52, 152, 219, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            border-left: 4px solid #3498db;
        }
        
        .email-notice i {
            color: #3498db;
            margin-right: 10px;
        }
        
        .report-preparing {
            display: none;
            text-align: center;
            padding: 30px;
            margin: 20px 0;
            background: rgba(15, 52, 96, 0.5);
            border-radius: 15px;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
        
        .report-preparing i {
            font-size: 3rem;
            color: #d4af37;
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }
        
        @media (max-width: 900px) {
            .form-section {
                grid-template-columns: 1fr;
            }
            
            .options {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .container {
                padding: 30px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .quiz-header-controls {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        @media (max-width: 600px) {
            body {
                padding: 15px;
            }
            
            .container {
                width: 100%;
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .header-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-btn {
                width: 100%;
                justify-content: center;
            }
            
            .share-buttons {
                flex-direction: column;
            }
            
            .quiz-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .quiz-header-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .mode-toggle {
                top: 10px;
                right: 10px;
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
            
            .instructions-toggle {
                top: 10px;
                right: 65px;
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
            
            .review-status {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <button class="mode-toggle" id="modeToggle">
        <i class="fas fa-moon"></i>
    </button>
    
    <button class="instructions-toggle" id="instructionsToggle">
        <i class="fas fa-info"></i>
    </button>
    
    <div class="container">
        <div class="premium-badge">PREMIUM</div>
        
        <div class="main-header" id="mainHeader">
            <header>
                <div class="logo">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h1>Sankalp Shiksha <span class="gold-accent">Premium</span></h1>
                <p class="description">Experience the next generation of AI-powered quiz generation with premium features and detailed analytics</p>
                
                <div class="header-controls">
                    <button class="control-btn secondary" id="feedbackBtn">
                        <i class="fas fa-comment"></i> Feedback
                    </button>
                    <button class="control-btn" id="websiteBtn">
                        <i class="fas fa-external-link-alt"></i> Visit Website
                    </button>
                </div>
            </header>
        </div>
        
        <div class="setup-container" id="setupContainer">
            <h2><i class="fas fa-cog gold-accent"></i> Premium Quiz Setup</h2>
            
            <div class="premium-feature">
                <i class="fas fa-star"></i>
                <div>
                    <strong>Premium Feature:</strong> Generate up to 10 questions with detailed explanations and receive a comprehensive report via email within 12 hours.
                </div>
            </div>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="examBoard">Exam/Board:</label>
                    <select id="examBoard">
                        <option value="cbse">CBSE</option>
                        <option value="icse">ICSE</option>
                        <option value="state">State Board</option>
                        <option value="igcse">IGCSE</option>
                        <option value="ib">International Baccalaureate (IB)</option>
                        <option value="neet">NEET</option>
                        <option value="jee">JEE</option>
                        <option value="upsc">UPSC</option>
                        <option value="ssc">SSC</option>
                        <option value="other">Other Exam/Board</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="classLevel">Class/Course Level:</label>
                    <select id="classLevel">
                        <option value="class1">Class 1</option>
                        <option value="class2">Class 2</option>
                        <option value="class3">Class 3</option>
                        <option value="class4">Class 4</option>
                        <option value="class5">Class 5</option>
                        <option value="class6">Class 6</option>
                        <option value="class7">Class 7</option>
                        <option value="class8">Class 8</option>
                        <option value="class9">Class 9</option>
                        <option value="class10">Class 10</option>
                        <option value="class11">Class 11</option>
                        <option value="class12">Class 12</option>
                        <option value="undergrad">Undergraduate</option>
                        <option value="grad">Graduate</option>
                        <option value="professional">Professional</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="subject">Subject:</label>
                    <select id="subject">
                        <option value="math">Mathematics</option>
                        <option value="science">Science</option>
                        <option value="physics">Physics</option>
                        <option value="chemistry">Chemistry</option>
                        <option value="biology">Biology</option>
                        <option value="history">History</option>
                        <option value="geography">Geography</option>
                        <option value="civics">Civics</option>
                        <option value="english">English</option>
                        <option value="hindi">Hindi</option>
                        <option value="sanskrit">Sanskrit</option>
                        <option value="computer">Computer Science</option>
                        <option value="arts">Arts</option>
                        <option value="music">Music</option>
                        <option value="physical">Physical Education</option>
                        <option value="general">General Knowledge</option>
                        <option value="other">Other Subject</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="topic">Topics/Chapter (optional):</label>
                    <input type="text" id="topic" placeholder="e.g., Algebra, World War II, Photosynthesis...">
                </div>
            </div>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="language">Language:</label>
                    <select id="language">
                        <option value="english" selected>English</option>
                        <option value="hindi">Hindi</option>
                        <option value="spanish">Spanish</option>
                        <option value="french">French</option>
                        <option value="german">German</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="difficulty">Difficulty Level:</label>
                    <select id="difficulty">
                        <option value="easy">Easy</option>
                        <option value="medium" selected>Medium</option>
                        <option value="hard">Hard</option>
                    </select>
                </div>
            </div>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="questionCount">Number of Questions (Max 10):</label>
                    <input type="number" id="questionCount" min="1" max="10" value="5">
                </div>
                
                <div class="form-group">
                    <label for="timeLimit">Time Limit (minutes, 0 for no limit):</label>
                    <input type="number" id="timeLimit" min="0" max="120" value="10">
                </div>
            </div>
            
            <div class="centered-button-container">
                <button id="generateBtn" class="centered-button"><i class="fas fa-crown"></i> Generate Premium Quiz</button>
            </div>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Generating Your Premium Quiz With Advanced AI</p>
        </div>
        
        <div class="quiz-container" id="quizContainer">
            <div class="quiz-header">
                <h2 class="quiz-title">Premium Quiz</h2>
                <div class="quiz-header-controls">
                    <button class="action-btn secondary" id="backBtn">
                        <i class="fas fa-home"></i> Home
                    </button>
                </div>
            </div>
            
            <div class="timer-container">
                <div>Time Remaining:</div>
                <div class="timer" id="timer">10:00</div>
            </div>
            
            <div class="review-panel" id="reviewPanel">
                <div class="review-title">
                    <i class="fas fa-list gold-accent"></i> Question Review
                </div>
                <div class="review-status">
                    <div class="status-item">
                        <span class="status-color status-answered"></span>
                        <span>Answered</span>
                    </div>
                    <div class="status-item">
                        <span class="status-color status-skipped"></span>
                        <span>Skipped</span>
                    </div>
                    <div class="status-item">
                        <span class="status-color status-unanswered"></span>
                        <span>Unanswered</span>
                    </div>
                    <div class="status-item">
                        <span class="status-color status-current"></span>
                        <span>Current</span>
                    </div>
                </div>
                <div class="review-buttons" id="reviewButtons"></div>
            </div>
            
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div id="questionContainer"></div>
            <div class="navigation">
                <button class="nav-btn secondary" id="prevBtn"><i class="fas fa-arrow-left"></i> Previous</button>
                <button class="nav-btn" id="nextBtn">Next <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="centered-button-container">
                <button id="submitQuiz" class="centered-button" style="display: none;"><i class="fas fa-paper-plane"></i> Submit Quiz</button>
            </div>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <h2><i class="fas fa-chart-line gold-accent"></i> Premium Quiz Results</h2>
            <div class="score" id="score"></div>
            
            <div class="email-notice">
                <i class="fas fa-envelope"></i>
                <strong>Premium Report:</strong> A detailed analysis of your quiz performance will be sent to your email within 12 hours.
            </div>
            
            <div class="analysis" id="analysis"></div>
            
            <div class="share-buttons">
                <button class="share-btn facebook" id="shareFacebook">
                    <i class="fab fa-facebook"></i> Share on Facebook
                </button>
                <button class="share-btn twitter" id="shareTwitter">
                    <i class="fab fa-twitter"></i> Share on Twitter
                </button>
                <button class="share-btn whatsapp" id="shareWhatsApp">
                    <i class="fab fa-whatsapp"></i> Share on WhatsApp
                </button>
            </div>
            
            <div class="centered-button-container">
                <button id="newQuizBtn" class="centered-button"><i class="fas fa-plus"></i> Create New Quiz</button>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2025 Sankalp Shiksha Premium.</p>
            <p>Visit our website: <a href="https://www.sankalpshiksha.com" target="_blank">www.sankalpshiksha.com</a></p>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h2><i class="fas fa-comment gold-accent"></i> Premium Feedback</h2>
            <p>We value your feedback! Please help us improve our premium quiz platform.</p>
            
            <form id="feedbackForm" class="feedback-form">
                <div class="form-group">
                    <label for="feedbackName">Your Name (optional):</label>
                    <input type="text" id="feedbackName" placeholder="Enter your name">
                </div>
                
                <div class="form-group">
                    <label for="feedbackExperience">Your Experience <span class="form-required">*</span></label>
                    <textarea id="feedbackExperience" required placeholder="Please share your experience with our premium quiz platform..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="feedbackSuggestions">Suggestions for New Features:</label>
                    <textarea id="feedbackSuggestions" placeholder="What new premium features would you like to see?"></textarea>
                </div>
                
                <div class="centered-button-container">
                    <button type="submit" class="centered-button feedback-submit">
                        <i class="fas fa-paper-plane"></i> Submit Feedback
                    </button>
                </div>
            </form>
            
            <div class="feedback-success" id="feedbackSuccess">
                <i class="fas fa-check-circle"></i>
                <h3>Thank You!</h3>
                <p>Your premium feedback has been successfully submitted.</p>
            </div>
        </div>
    </div>

    <!-- Instructions Modal -->
    <div class="modal" id="instructionsModal">
        <div class="modal-content">
            <span class="close-modal" id="closeInstructionsModal">&times;</span>
            <h2><i class="fas fa-info-circle gold-accent"></i> Premium Quiz Instructions</h2>
            <div class="instructions-content">
                <p><strong>Premium Features:</strong> Enjoy up to 10 questions with detailed explanations and receive a comprehensive report via email.</p>
                
                <h3>How to Use:</h3>
                <ol>
                    <li>Fill in the premium quiz setup form with your preferences</li>
                    <li>Click "Generate Premium Quiz" to create your customized quiz</li>
                    <li>Navigate through questions using Previous/Next buttons</li>
                    <li>Select an answer by clicking on any option</li>
                    <li>Use the question review panel to track your progress</li>
                    <li>Click "Submit Quiz" when you're finished</li>
                    <li>Receive a detailed report via email within 12 hours</li>
                </ol>
                
                <h3>Question Status:</h3>
                <ul>
                    <li><span style="color: #2ecc71; font-weight: bold;">Answered</span>: Questions you've answered</li>
                    <li><span style="color: #f39c12; font-weight: bold;">Skipped</span>: Questions you've visited but not answered</li>
                    <li><span style="color: #e74c3c; font-weight: bold;">Unanswered</span>: Questions you haven't visited yet</li>
                    <li><span style="color: #3498db; font-weight: bold;">Current</span>: The question you're currently viewing</li>
                </ul>
                
                <p>You can click on any question number in the review panel to jump directly to that question.</p>
            </div>
        </div>
    </div>

    <!-- User Details Modal -->
    <div class="modal" id="userDetailsModal">
        <div class="modal-content">
            <span class="close-modal" id="closeUserDetailsModal">&times;</span>
            <h2><i class="fas fa-user gold-accent"></i> Premium User Information</h2>
            <p>Please provide your details to generate the premium quiz and receive your detailed report.</p>
            
            <form id="userDetailsForm" class="user-details-form">
                <div class="form-group">
                    <label for="userName">Full Name <span class="form-required">*</span></label>
                    <input type="text" id="userName" required placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="userEmail">Email Address <span class="form-required">*</span></label>
                    <input type="email" id="userEmail" required placeholder="Enter your email address">
                </div>
                
                <div class="form-group">
                    <label for="userPhone">Phone Number (optional)</label>
                    <input type="tel" id="userPhone" placeholder="Enter your phone number">
                </div>
                
                <div class="centered-button-container">
                    <button type="submit" class="centered-button user-details-submit">
                        <i class="fas fa-check"></i> Submit & Generate Premium Quiz
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // TypeScript-style type definitions
        /**
         * @typedef {Object} QuizQuestion
         * @property {string} question - The question text
         * @property {string[]} options - Array of answer options
         * @property {string} answer - Correct answer (A, B, C, or D)
         * @property {string} explanation - Explanation for the correct answer
         */
        
        /**
         * @typedef {Object} UserDetails
         * @property {string} name - User's full name
         * @property {string} email - User's email address
         * @property {string} phone - User's phone number (optional)
         */
        
        /**
         * @typedef {Object} QuizSettings
         * @property {string} examBoard - Selected exam board
         * @property {string} classLevel - Selected class level
         * @property {string} subject - Selected subject
         * @property {string} topic - Topic or chapter (optional)
         * @property {string} language - Language for the quiz
         * @property {string} difficulty - Difficulty level
         * @property {number} questionCount - Number of questions
         * @property {number} timeLimit - Time limit in minutes
         */

        // DOM elements
        const setupContainer = document.getElementById('setupContainer');
        const loading = document.getElementById('loading');
        const quizContainer = document.getElementById('quizContainer');
        const resultsContainer = document.getElementById('resultsContainer');
        const generateBtn = document.getElementById('generateBtn');
        const questionContainer = document.getElementById('questionContainer');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitQuiz = document.getElementById('submitQuiz');
        const progressBar = document.getElementById('progressBar');
        const scoreElement = document.getElementById('score');
        const analysisElement = document.getElementById('analysis');
        const newQuizBtn = document.getElementById('newQuizBtn');
        const feedbackBtn = document.getElementById('feedbackBtn');
        const websiteBtn = document.getElementById('websiteBtn');
        const feedbackModal = document.getElementById('feedbackModal');
        const closeModal = document.getElementById('closeModal');
        const timerElement = document.getElementById('timer');
        const backBtn = document.getElementById('backBtn');
        const shareFacebook = document.getElementById('shareFacebook');
        const shareTwitter = document.getElementById('shareTwitter');
        const shareWhatsApp = document.getElementById('shareWhatsApp');
        const mainHeader = document.getElementById('mainHeader');
        const modeToggle = document.getElementById('modeToggle');
        const modeIcon = modeToggle.querySelector('i');
        const instructionsToggle = document.getElementById('instructionsToggle');
        const instructionsModal = document.getElementById('instructionsModal');
        const closeInstructionsModal = document.getElementById('closeInstructionsModal');
        const reviewPanel = document.getElementById('reviewPanel');
        const reviewButtons = document.getElementById('reviewButtons');
        const userDetailsModal = document.getElementById('userDetailsModal');
        const userDetailsForm = document.getElementById('userDetailsForm');
        const closeUserDetailsModal = document.getElementById('closeUserDetailsModal');
        const feedbackForm = document.getElementById('feedbackForm');
        const feedbackSuccess = document.getElementById('feedbackSuccess');
        
        // Form elements
        const examBoard = document.getElementById('examBoard');
        const classLevel = document.getElementById('classLevel');
        const subject = document.getElementById('subject');
        const topic = document.getElementById('topic');
        const language = document.getElementById('language');
        const difficulty = document.getElementById('difficulty');
        const questionCount = document.getElementById('questionCount');
        const timeLimit = document.getElementById('timeLimit');
        
        // API Configuration
        const OPENROUTER_API_KEY = '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';
        const OPENROUTER_API_URL = 'https://openrouter.ai/api/v1/chat/completions';
        const OPENROUTER_MODEL = 'x-ai/grok-4-fast:free';
        
        // Quiz variables
        let currentQuestionIndex = 0;
        let userAnswers = [];
        /** @type {QuizQuestion[]} */
        let quizData = [];
        let timerInterval = null;
        let timeLeft = 0;
        let visitedQuestions = [];
        /** @type {UserDetails} */
        let userDetails = {};
        
        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
            modeIcon.classList.remove('fa-moon');
            modeIcon.classList.add('fa-sun');
        }
        
        // Event listeners
        generateBtn.addEventListener('click', showUserDetailsModal);
        prevBtn.addEventListener('click', showPreviousQuestion);
        nextBtn.addEventListener('click', showNextQuestion);
        submitQuiz.addEventListener('click', showResults);
        newQuizBtn.addEventListener('click', resetQuiz);
        feedbackBtn.addEventListener('click', showFeedbackModal);
        websiteBtn.addEventListener('click', visitWebsite);
        closeModal.addEventListener('click', closeFeedbackModal);
        backBtn.addEventListener('click', goBackToHome);
        shareFacebook.addEventListener('click', shareOnFacebook);
        shareTwitter.addEventListener('click', shareOnTwitter);
        shareWhatsApp.addEventListener('click', shareOnWhatsApp);
        modeToggle.addEventListener('click', toggleDarkMode);
        instructionsToggle.addEventListener('click', showInstructionsModal);
        closeInstructionsModal.addEventListener('click', closeInstructionsModalFunc);
        userDetailsForm.addEventListener('submit', handleUserDetailsSubmit);
        closeUserDetailsModal.addEventListener('click', closeUserDetailsModalFunc);
        feedbackForm.addEventListener('submit', handleFeedbackSubmit);
        
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === feedbackModal) {
                closeFeedbackModal();
            }
            if (e.target === instructionsModal) {
                closeInstructionsModalFunc();
            }
            if (e.target === userDetailsModal) {
                closeUserDetailsModalFunc();
            }
        });
        
        // Show user details modal
        function showUserDetailsModal() {
            userDetailsModal.style.display = 'flex';
        }
        
        // Close user details modal
        function closeUserDetailsModalFunc() {
            userDetailsModal.style.display = 'none';
        }
        
        // Handle user details form submission
        function handleUserDetailsSubmit(e) {
            e.preventDefault();
            
            const userName = document.getElementById('userName').value;
            const userEmail = document.getElementById('userEmail').value;
            const userPhone = document.getElementById('userPhone').value;
            
            if (!userName || !userEmail) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(userEmail)) {
                alert('Please enter a valid email address');
                return;
            }
            
            // Save user details
            userDetails = {
                name: userName,
                email: userEmail,
                phone: userPhone || 'Not provided'
            };
            
            // Close the modal
            closeUserDetailsModalFunc();
            
            // Save user details to Google Sheets
            saveUserDetailsToSheet();
            
            // Generate the quiz
            generateQuiz();
        }
        
        // Save user details to Google Sheets
        async function saveUserDetailsToSheet() {
            try {
                // Prepare the data to send
                const formData = {
                    name: userDetails.name,
                    email: userDetails.email,
                    phone: userDetails.phone,
                    examBoard: examBoard.options[examBoard.selectedIndex].text,
                    classLevel: classLevel.options[classLevel.selectedIndex].text,
                    subject: subject.options[subject.selectedIndex].text,
                    topic: topic.value || 'General',
                    difficulty: difficulty.options[difficulty.selectedIndex].text,
                    questionCount: questionCount.value,
                    timestamp: new Date().toLocaleString()
                };
                
                // Send data to Google Apps Script
                const response = await fetch('https://script.google.com/macros/s/AKfycby__amSbCkt-Rmvh03BHXEczw5yZXCsNfNgjjPJph_0AQUgcAUk8_yDQ-9ttKHbFpxQGw/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                // Note: We're using no-cors mode so we won't get a response
                console.log('User details submitted to Google Sheets');
            } catch (error) {
                console.error('Error saving user details:', error);
                // Continue with quiz generation even if saving fails
            }
        }
        
        // Handle feedback form submission
        async function handleFeedbackSubmit(e) {
            e.preventDefault();
            
            const feedbackName = document.getElementById('feedbackName').value || 'Anonymous';
            const feedbackExperience = document.getElementById('feedbackExperience').value;
            const feedbackSuggestions = document.getElementById('feedbackSuggestions').value || 'No suggestions provided';
            
            if (!feedbackExperience) {
                alert('Please share your experience before submitting');
                return;
            }
            
            try {
                // Prepare the feedback data to send
                const feedbackData = {
                    name: feedbackName,
                    experience: feedbackExperience,
                    suggestions: feedbackSuggestions,
                    timestamp: new Date().toLocaleString()
                };
                
                // Send feedback data to Google Apps Script
                await fetch('https://script.google.com/macros/s/AKfycbxQJKlVWabcNjUGqKULJx5z7q0mKMhqwUMixlBp55byT-qdAPs_53KQAEU0LYFb_0US/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(feedbackData)
                });
                
                // Show success message
                feedbackForm.style.display = 'none';
                feedbackSuccess.style.display = 'block';
                
                // Close modal after 2 seconds
                setTimeout(() => {
                    closeFeedbackModal();
                    feedbackForm.style.display = 'block';
                    feedbackSuccess.style.display = 'none';
                    feedbackForm.reset();
                }, 2000);
                
            } catch (error) {
                console.error('Error submitting feedback:', error);
                alert('There was an error submitting your feedback. Please try again.');
            }
        }
        
        // Toggle dark mode
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                modeIcon.classList.remove('fa-moon');
                modeIcon.classList.add('fa-sun');
            } else {
                localStorage.setItem('darkMode', 'disabled');
                modeIcon.classList.remove('fa-sun');
                modeIcon.classList.add('fa-moon');
            }
        }
        
        // Show instructions modal
        function showInstructionsModal() {
            instructionsModal.style.display = 'flex';
        }
        
        // Close instructions modal
        function closeInstructionsModalFunc() {
            instructionsModal.style.display = 'none';
        }
        
        // Show feedback modal
        function showFeedbackModal() {
            feedbackModal.style.display = 'flex';
        }
        
        // Close feedback modal
        function closeFeedbackModal() {
            feedbackModal.style.display = 'none';
            feedbackForm.style.display = 'block';
            feedbackSuccess.style.display = 'none';
            feedbackForm.reset();
        }
        
        // Generate quiz using AI via OpenRouter API
        async function generateQuiz() {
            const examBoardValue = examBoard.value;
            const classValue = classLevel.value;
            const subjectValue = subject.value;
            const topicValue = topic.value;
            const languageValue = language.value;
            const difficultyValue = difficulty.value;
            const questionCountValue = questionCount.value;
            const timeLimitValue = timeLimit.value;
            
            if (questionCountValue > 10) {
                alert('Maximum number of questions is 10');
                return;
            }
            
            if (!topicValue && subjectValue === 'general') {
                alert('Please enter a topic for your quiz or select a specific subject');
                return;
            }
            
            // Show loading, hide setup and header
            setupContainer.style.display = 'none';
            mainHeader.style.display = 'none';
            loading.style.display = 'block';
            
            try {
                // Create prompt for the AI
                const prompt = `
                    Create a ${difficultyValue} difficulty quiz for ${examBoardValue} ${classValue} level on the subject of ${subjectValue} ${topicValue ? 'with a focus on ' + topicValue : ''}.
                    Generate exactly ${questionCountValue} multiple choice questions in ${languageValue} language.
                    Each question should have 4 options labeled A, B, C, D and one correct answer.
                    Also include a detailed explanation for each correct answer.
                    Format the response as a JSON array without any additional text. Each object in the array should have:
                    - question: the question text
                    - options: array of 4 option strings
                    - answer: the correct answer (A, B, C, or D)
                    - explanation: a detailed explanation of why the answer is correct
                    
                    Example format:
                    [
                      {
                        "question": "What is the capital of France?",
                        "options": ["London", "Berlin", "Paris", "Madrid"],
                        "answer": "C",
                        "explanation": "Paris is the capital of France. It has been the country's political and cultural center for centuries, housing important institutions like the French government and the Louvre Museum."
                      }
                    ]
                `;
                
                // Make API request to OpenRouter
                const response = await fetch(OPENROUTER_API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${OPENROUTER_API_KEY}`,
                        'HTTP-Referer': 'https://www.sankalpshiksha.com',
                        'X-Title': 'Sankalp Shiksha Quiz Generator',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: OPENROUTER_MODEL,
                        messages: [
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 4000
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }
                
                const data = await response.json();
                const responseText = data.choices[0].message.content;
                
                // Extract JSON from response (might have backticks)
                const jsonMatch = responseText.match(/\[[\s\S]*\]/);
                if (jsonMatch) {
                    quizData = JSON.parse(jsonMatch[0]);
                    userAnswers = new Array(quizData.length).fill(null);
                    visitedQuestions = new Array(quizData.length).fill(false);
                    
                    // Initialize quiz
                    loading.style.display = 'none';
                    quizContainer.style.display = 'block';
                    currentQuestionIndex = 0;
                    visitedQuestions[0] = true;
                    
                    // Create review buttons
                    createReviewButtons();
                    updateReviewPanel();
                    
                    // Start timer if time limit is set
                    if (timeLimitValue > 0) {
                        startTimer(timeLimitValue * 60); // Convert minutes to seconds
                    } else {
                        timerElement.parentElement.style.display = 'none';
                    }
                    
                    updateProgressBar();
                    displayQuestion();
                } else {
                    throw new Error('Could not parse quiz data from API response');
                }
                
            } catch (error) {
                console.error('Error generating quiz:', error);
                loading.style.display = 'none';
                setupContainer.style.display = 'block';
                mainHeader.style.display = 'block';
                alert('Failed to generate quiz. Please try again with a different topic or subject.');
                
                // Use fallback data for demonstration
                useFallbackQuizData();
            }
        }
        
        // Create review buttons
        function createReviewButtons() {
            reviewButtons.innerHTML = '';
            for (let i = 0; i < quizData.length; i++) {
                const button = document.createElement('div');
                button.className = 'review-btn';
                button.textContent = i + 1;
                button.setAttribute('data-index', i);
                
                button.addEventListener('click', () => {
                    currentQuestionIndex = i;
                    visitedQuestions[i] = true;
                    updateProgressBar();
                    updateReviewPanel();
                    displayQuestion();
                });
                
                reviewButtons.appendChild(button);
            }
        }
        
        // Update review panel
        function updateReviewPanel() {
            const buttons = reviewButtons.querySelectorAll('.review-btn');
            buttons.forEach((button, index) => {
                const i = parseInt(button.getAttribute('data-index'));
                
                // Remove all status classes
                button.classList.remove('answered', 'skipped', 'unanswered', 'current');
                
                // Add appropriate status class
                if (i === currentQuestionIndex) {
                    button.classList.add('current');
                } else if (userAnswers[i] !== null) {
                    button.classList.add('answered');
                } else if (visitedQuestions[i]) {
                    button.classList.add('skipped');
                } else {
                    button.classList.add('unanswered');
                }
            });
        }
        
        // Start the timer
        function startTimer(seconds) {
            timeLeft = seconds;
            updateTimerDisplay();
            
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert('Time is up! Submitting your quiz now.');
                    showResults();
                } else if (timeLeft <= 60) {
                    // Less than 1 minute remaining
                    timerElement.classList.add('warning');
                }
            }, 1000);
        }
        
        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // Use fallback quiz data if API fails
        function useFallbackQuizData() {
            quizData = fallbackQuizData;
            userAnswers = new Array(quizData.length).fill(null);
            visitedQuestions = new Array(quizData.length).fill(false);
            
            loading.style.display = 'none';
            quizContainer.style.display = 'block';
            currentQuestionIndex = 0;
            visitedQuestions[0] = true;
            
            // Create review buttons
            createReviewButtons();
            updateReviewPanel();
            
            // Start timer if time limit is set
            const timeLimitValue = timeLimit.value;
            if (timeLimitValue > 0) {
                startTimer(timeLimitValue * 60);
            } else {
                timerElement.parentElement.style.display = 'none';
            }
            
            updateProgressBar();
            displayQuestion();
        }
        
        // Display current question
        function displayQuestion() {
            const question = quizData[currentQuestionIndex];
            questionContainer.innerHTML = `
                <div class="question">
                    <h3>Question ${currentQuestionIndex + 1}</h3>
                    <p>${question.question}</p>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option ${userAnswers[currentQuestionIndex] === String.fromCharCode(65 + index) ? 'selected' : ''}" 
                                 data-option="${String.fromCharCode(65 + index)}">
                                ${String.fromCharCode(65 + index)}. ${option}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // Add event listeners to options
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', selectOption);
            });
            
            // Update navigation buttons
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.disabled = false;
            submitQuiz.style.display = currentQuestionIndex === quizData.length - 1 ? 'block' : 'none';
            
            // Update review panel
            updateReviewPanel();
        }
        
        // Select an option
        function selectOption(e) {
            const selectedOption = e.target.getAttribute('data-option');
            userAnswers[currentQuestionIndex] = selectedOption;
            
            // Update UI
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });
            e.target.classList.add('selected');
            
            // Update review panel
            updateReviewPanel();
            
            // Auto-advance to next question after a short delay if not the last question
            if (currentQuestionIndex < quizData.length - 1) {
                setTimeout(showNextQuestion, 500);
            }
        }
        
        // Show next question
        function showNextQuestion() {
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                visitedQuestions[currentQuestionIndex] = true;
                updateProgressBar();
                updateReviewPanel();
                displayQuestion();
            }
        }
        
        // Show previous question
        function showPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                visitedQuestions[currentQuestionIndex] = true;
                updateProgressBar();
                updateReviewPanel();
                displayQuestion();
            }
        }
        
        // Update progress bar
        function updateProgressBar() {
            const progress = ((currentQuestionIndex + 1) / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        // Show results
        async function showResults() {
            // Stop the timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Show preparing report message
            const reportPreparing = document.createElement('div');
            reportPreparing.className = 'report-preparing';
            reportPreparing.innerHTML = `
                <i class="fas fa-cog fa-spin"></i>
                <h3>Preparing Your Premium Report</h3>
                <p>Your detailed analysis is being generated and will be sent to your email within 12 hours.</p>
            `;
            resultsContainer.insertBefore(reportPreparing, scoreElement);
            
            // Calculate score
            let correctCount = 0;
            quizData.forEach((question, index) => {
                if (userAnswers[index] === question.answer) {
                    correctCount++;
                }
            });
            
            const score = (correctCount / quizData.length) * 100;
            
            // Display score
            scoreElement.textContent = `Score: ${score.toFixed(1)}% (${correctCount}/${quizData.length})`;
            
            // Generate analysis
            let analysisHTML = `
                <h3>Quiz Details:</h3>
                <p><span class="badge">Exam/Board</span> ${examBoard.options[examBoard.selectedIndex].text}</p>
                <p><span class="badge">Class</span> ${classLevel.options[classLevel.selectedIndex].text}</p>
                <p><span class="badge">Subject</span> ${subject.options[subject.selectedIndex].text}</p>
                <p><span class="badge">Topic</span> ${topic.value || 'General'}</p>
                <p><span class="badge">Difficulty</span> ${difficulty.options[difficulty.selectedIndex].text}</p>
                
                <h3 style="margin-top: 15px;">Question Analysis:</h3>
            `;
            
            quizData.forEach((question, index) => {
                const isCorrect = userAnswers[index] === question.answer;
                const userAnswerLetter = userAnswers[index] || 'Not answered';
                const correctAnswerLetter = question.answer;
                const correctAnswerIndex = correctAnswerLetter.charCodeAt(0) - 65;
                const correctAnswerText = question.options[correctAnswerIndex];
                
                analysisHTML += `
                    <div class="question-analysis">
                        <p><strong>Question ${index + 1}:</strong> ${question.question}</p>
                        <p class="${isCorrect ? 'correct' : 'incorrect'}">
                            Your answer: ${userAnswerLetter} 
                            ${isCorrect ? 'â Correct' : 'â Incorrect'}
                        </p>
                        <div class="correct-answer">
                            <strong>Correct Answer:</strong> ${correctAnswerLetter}. ${correctAnswerText}
                        </div>
                        <div class="explanation">
                            <strong>Explanation:</strong> ${question.explanation || 'No explanation available.'}
                        </div>
                    </div>
                `;
            });
            
            analysisElement.innerHTML = analysisHTML;
            
            // Save quiz results to Google Doc
            await saveQuizResultsToDoc(score, correctCount, quizData.length);
            
            // Remove preparing report message after 3 seconds
            setTimeout(() => {
                reportPreparing.style.display = 'none';
            }, 3000);
            
            // Show results, hide quiz
            quizContainer.style.display = 'none';
            resultsContainer.style.display = 'block';
        }
        
        // Save quiz results to Google Doc
        async function saveQuizResultsToDoc(score, correctCount, totalQuestions) {
            try {
                // Prepare quiz results data
                const quizResults = {
                    userName: userDetails.name,
                    userEmail: userDetails.email,
                    userPhone: userDetails.phone,
                    examBoard: examBoard.options[examBoard.selectedIndex].text,
                    classLevel: classLevel.options[classLevel.selectedIndex].text,
                    subject: subject.options[subject.selectedIndex].text,
                    topic: topic.value || 'General',
                    difficulty: difficulty.options[difficulty.selectedIndex].text,
                    questionCount: questionCount.value,
                    timeLimit: timeLimit.value,
                    score: score.toFixed(1),
                    correctAnswers: correctCount,
                    totalQuestions: totalQuestions,
                    timestamp: new Date().toLocaleString(),
                    // Include all questions and answers for detailed report
                    questions: quizData.map((q, index) => ({
                        question: q.question,
                        userAnswer: userAnswers[index] || 'Not answered',
                        correctAnswer: q.answer,
                        explanation: q.explanation,
                        options: q.options
                    }))
                };
                
                // Send quiz results to Google Apps Script
                await fetch('https://script.google.com/macros/s/AKfycby03ujzMCjaq-47Dw2Q9m33p6B5pVcMctDKotKH8YdAa90sFhrzl7dRvcjLoyYZFJIj3Q/exec', {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(quizResults)
                });
                
                console.log('Quiz results saved to Google Doc');
            } catch (error) {
                console.error('Error saving quiz results:', error);
                // Continue even if saving fails
            }
        }
        
        // Reset quiz
        function resetQuiz() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            timerElement.classList.remove('warning');
            timerElement.parentElement.style.display = 'flex';
            
            resultsContainer.style.display = 'none';
            setupContainer.style.display = 'block';
            mainHeader.style.display = 'block';
            currentQuestionIndex = 0;
            userAnswers = [];
            quizData = [];
            visitedQuestions = [];
            userDetails = {};
            
            // Reset the user details form
            userDetailsForm.reset();
        }
        
        // Go back to home screen
        function goBackToHome() {
            if (confirm('Are you sure you want to go back? Your current progress will be lost.')) {
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
                
                quizContainer.style.display = 'none';
                setupContainer.style.display = 'block';
                mainHeader.style.display = 'block';
                currentQuestionIndex = 0;
                userAnswers = [];
                quizData = [];
                visitedQuestions = [];
                userDetails = {};
                
                // Reset the user details form
                userDetailsForm.reset();
            }
        }
        
        // Share on Facebook
        function shareOnFacebook() {
            const scoreText = scoreElement.textContent;
            const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent('https://nexgenaitech.github.io/x/ssqz')}&quote=${encodeURIComponent(`I scored ${scoreText} on Sankalp Shiksha Premium Quiz!`)}`;
            window.open(shareUrl, '_blank');
        }
        
        // Share on Twitter
        function shareOnTwitter() {
            const scoreText = scoreElement.textContent;
            const shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(`I scored ${scoreText} on Sankalp Shiksha Premium Quiz! Check it out at https://nexgenaitech.github.io/x/ssqz`)}`;
            window.open(shareUrl, '_blank');
        }
        
        // Share on WhatsApp
        function shareOnWhatsApp() {
            const scoreText = scoreElement.textContent;
            const shareUrl = `https://wa.me/?text=${encodeURIComponent(`I scored ${scoreText} on Sankalp Shiksha Premium Quiz! Check it out at https://nexgenaitech.github.io/x/ssqz`)}`;
            window.open(shareUrl, '_blank');
        }
        
        // Visit website
        function visitWebsite() {
            window.open("https://www.sankalpshiksha.com", "_blank");
        }
        
        // Fallback quiz data in case API fails (for demonstration)
        const fallbackQuizData = [
            {
                question: "What is the capital of France?",
                options: ["London", "Berlin", "Paris", "Madrid"],
                answer: "C",
                explanation: "Paris is the capital of France. It has been the country's political and cultural center for centuries, housing important institutions like the French government and the Louvre Museum."
            },
            {
                question: "Which planet is known as the Red Planet?",
                options: ["Venus", "Mars", "Jupiter", "Saturn"],
                answer: "B",
                explanation: "Mars is known as the Red Planet due to its reddish appearance, which is caused by iron oxide (rust) on its surface. It's the fourth planet from the Sun and has been a subject of extensive scientific exploration."
            },
            {
                question: "What is the largest mammal in the world?",
                options: ["Elephant", "Blue Whale", "Giraffe", "Hippopotamus"],
                answer: "B",
                explanation: "The Blue Whale is the largest mammal on Earth, reaching lengths of up to 100 feet and weights of up to 200 tons. Despite their massive size, they feed primarily on tiny krill."
            },
            {
                question: "Which element has the chemical symbol 'O'?",
                options: ["Gold", "Oxygen", "Osmium", "Oganesson"],
                answer: "B",
                explanation: "Oxygen has the chemical symbol 'O'. It is a highly reactive nonmetal and the third-most abundant element in the universe. It's essential for most life forms through the process of respiration."
            },
            {
                question: "Who wrote 'Romeo and Juliet'?",
                options: ["Charles Dickens", "William Shakespeare", "Jane Austen", "Mark Twain"],
                answer: "B",
                explanation: "William Shakespeare wrote 'Romeo and Juliet' in the late 16th century. It is one of his most famous tragedies, telling the story of two young star-crossed lovers whose deaths ultimately reconcile their feuding families."
            }
        ];
    </script>
</body>
</html>

